<div>
	<h1 class="page_title">Store Map</h1>
	<hr/>
    <div id="mapsvg_store_list"></div>     
    
	<!--<select class="mapper" id="store_select_container">-->
	<!--    <script id="store_select_template" type="x-tmpl-mustache/text">-->
 <!--           <option value="{{x_coordinate}},{{y_coordinate}},{{id}}" data-value="{{name}}">{{name}}</option>-->
 <!--       </script>-->
	<!--</select>-->
	<!--<div id="parent_div">-->
	<!--	<div id="zoom_container"  >-->
	<!--		<img alt="Store Directory Map" id="map_image" src=""/>-->
	<!--		<div class="landmarks" data-show-at-zoom="100" data-allow-drag="true"></div>-->
	<!--	</div>-->
	<!--</div>-->
</div>
<div class="mobile_line_break"></div>
<script>
    $(document).ready(function(){
        function renderAll(){
            var stores = getStoresList();
            console.log(stores);
            
            regions = {};
            var stores = getStoresList();
            $.each(stores, function(key, val) {
                if(val.svgmap_region != null && typeof(val.svgmap_region)  != 'undefined'){
                    obj = {};
                    obj["tooltip"] = "<div class='tooltip_div'><p class='tooltip_name'>" + val.name + "</p><div class='tooltip_phone_div'><i class='tooltip_phone_icon fa fa-phone' aria-hidden='true'></i><p class='tooltip_phone'>" + val.phone + "</p></div>"
                    obj["attr"] = {}
                    obj["attr"]["href"] = "/stores/" + val.slug
                    regions[val.svgmap_region] = obj
                }
            });
            load_map(regions, stores);
        }

            
        function load_map(regions, stores){
            this_region = {};
            this_region = stores.svgmap_region;
            map = $('#mapsvg').mapSvg({
                source: getSVGMapURL(),    // Path to SVG map
                colors: {stroke: '#aaaaaa', selected: '#f57b2b', hover: "#f57b2b"},
                disableAll: true,
                // height: 450,
                // width: 690,
                regions: regions,
                tooltipsMode: 'custom',
                loadingText: "loading...",
                zoom: true,
                zoomButtons: {'show': true,'location': 'left' },
                pan: true,
                scroll: false,
                cursor:'move',
                responsive: true,
                zoomLimit: [0, 10],
            });
            map.selectRegion(stores.svgmap_region);
        }

        loadMallDataCached(renderAll);
    })
</script>